[gd_scene load_steps=20 format=3 uid="uid://arena03_forest"]

[ext_resource type="Script" path="res://scripts/levels/arena_manager.gd" id="1"]
[ext_resource type="PackedScene" uid="uid://player_fps001" path="res://scenes/player/player_fps.tscn" id="2"]
[ext_resource type="Script" path="res://scripts/systems/sigil.gd" id="4"]
[ext_resource type="PackedScene" uid="uid://destructible_crate001" path="res://scenes/props/destructible_crate.tscn" id="5"]
[ext_resource type="PackedScene" uid="uid://hud001" path="res://scenes/ui/hud.tscn" id="6"]
[ext_resource type="PackedScene" uid="uid://chat_ui001" path="res://scenes/ui/chat_ui.tscn" id="7"]

[sub_resource type="BoxMesh" id="FloorMesh"]
size = Vector3(100, 0.5, 100)

[sub_resource type="StandardMaterial3D" id="GrassMaterial"]
albedo_color = Color(0.2, 0.35, 0.15, 1)
roughness = 0.95

[sub_resource type="CylinderMesh" id="TreeTrunkMesh"]
top_radius = 0.3
bottom_radius = 0.5
height = 6

[sub_resource type="StandardMaterial3D" id="TreeTrunkMaterial"]
albedo_color = Color(0.35, 0.25, 0.15, 1)
roughness = 0.9

[sub_resource type="SphereMesh" id="TreeFoliageMesh"]
radius = 2.5
height = 4

[sub_resource type="StandardMaterial3D" id="FoliageMaterial"]
albedo_color = Color(0.15, 0.4, 0.12, 1)
roughness = 0.8

[sub_resource type="CylinderMesh" id="SigilMesh"]
top_radius = 2.5
bottom_radius = 2.5
height = 0.3

[sub_resource type="StandardMaterial3D" id="SigilMaterial"]
albedo_color = Color(0.3, 0.8, 0.4, 0.8)
emission_enabled = true
emission = Color(0.2, 0.7, 0.3)
emission_energy_multiplier = 2.0

[sub_resource type="BoxMesh" id="RockMesh"]
size = Vector3(3, 2, 2.5)

[sub_resource type="StandardMaterial3D" id="RockMaterial"]
albedo_color = Color(0.4, 0.4, 0.42, 1)
roughness = 0.95

[sub_resource type="BoxShape3D" id="FloorShape"]
size = Vector3(100, 0.5, 100)

[sub_resource type="NavigationMesh" id="NavMesh"]
vertices = PackedVector3Array(-50, 0.25, -50, -50, 0.25, 50, 50, 0.25, 50, 50, 0.25, -50)
polygons = [PackedInt32Array(0, 1, 2, 3)]
agent_radius = 0.6
agent_height = 2.0

[sub_resource type="ProceduralSkyMaterial" id="SkyMaterial"]
sky_horizon_color = Color(0.6, 0.7, 0.8, 1)
ground_horizon_color = Color(0.6, 0.7, 0.75, 1)

[sub_resource type="Sky" id="Sky"]
sky_material = SubResource("SkyMaterial")

[node name="Arena03_Forest" type="Node3D"]
script = ExtResource("1")

[node name="Environment" type="Node3D" parent="."]

[node name="Ground" type="MeshInstance3D" parent="Environment"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.25, 0)
mesh = SubResource("FloorMesh")
surface_material_override/0 = SubResource("GrassMaterial")

[node name="GroundCollision" type="StaticBody3D" parent="Environment/Ground"]
collision_layer = 1
collision_mask = 6

[node name="CollisionShape3D" type="CollisionShape3D" parent="Environment/Ground/GroundCollision"]
shape = SubResource("FloorShape")

[node name="Trees" type="Node3D" parent="Environment"]

[node name="Tree1" type="Node3D" parent="Environment/Trees"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -30, 0, -25)

[node name="Trunk" type="MeshInstance3D" parent="Environment/Trees/Tree1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3, 0)
mesh = SubResource("TreeTrunkMesh")
surface_material_override/0 = SubResource("TreeTrunkMaterial")

[node name="Foliage" type="MeshInstance3D" parent="Environment/Trees/Tree1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 7, 0)
mesh = SubResource("TreeFoliageMesh")
surface_material_override/0 = SubResource("FoliageMaterial")

[node name="Tree2" type="Node3D" parent="Environment/Trees"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 30, 0, -25)

[node name="Trunk" type="MeshInstance3D" parent="Environment/Trees/Tree2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3, 0)
mesh = SubResource("TreeTrunkMesh")
surface_material_override/0 = SubResource("TreeTrunkMaterial")

[node name="Foliage" type="MeshInstance3D" parent="Environment/Trees/Tree2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 7, 0)
mesh = SubResource("TreeFoliageMesh")
surface_material_override/0 = SubResource("FoliageMaterial")

[node name="Tree3" type="Node3D" parent="Environment/Trees"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -30, 0, 25)

[node name="Trunk" type="MeshInstance3D" parent="Environment/Trees/Tree3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3, 0)
mesh = SubResource("TreeTrunkMesh")
surface_material_override/0 = SubResource("TreeTrunkMaterial")

[node name="Foliage" type="MeshInstance3D" parent="Environment/Trees/Tree3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 7, 0)
mesh = SubResource("TreeFoliageMesh")
surface_material_override/0 = SubResource("FoliageMaterial")

[node name="Tree4" type="Node3D" parent="Environment/Trees"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 30, 0, 25)

[node name="Trunk" type="MeshInstance3D" parent="Environment/Trees/Tree4"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3, 0)
mesh = SubResource("TreeTrunkMesh")
surface_material_override/0 = SubResource("TreeTrunkMaterial")

[node name="Foliage" type="MeshInstance3D" parent="Environment/Trees/Tree4"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 7, 0)
mesh = SubResource("TreeFoliageMesh")
surface_material_override/0 = SubResource("FoliageMaterial")

[node name="Tree5" type="Node3D" parent="Environment/Trees"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -15, 0, -35)

[node name="Trunk" type="MeshInstance3D" parent="Environment/Trees/Tree5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3, 0)
mesh = SubResource("TreeTrunkMesh")
surface_material_override/0 = SubResource("TreeTrunkMaterial")

[node name="Foliage" type="MeshInstance3D" parent="Environment/Trees/Tree5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 7, 0)
mesh = SubResource("TreeFoliageMesh")
surface_material_override/0 = SubResource("FoliageMaterial")

[node name="Tree6" type="Node3D" parent="Environment/Trees"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 15, 0, 35)

[node name="Trunk" type="MeshInstance3D" parent="Environment/Trees/Tree6"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3, 0)
mesh = SubResource("TreeTrunkMesh")
surface_material_override/0 = SubResource("TreeTrunkMaterial")

[node name="Foliage" type="MeshInstance3D" parent="Environment/Trees/Tree6"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 7, 0)
mesh = SubResource("TreeFoliageMesh")
surface_material_override/0 = SubResource("FoliageMaterial")

[node name="Rocks" type="Node3D" parent="Environment"]

[node name="Rock1" type="MeshInstance3D" parent="Environment/Rocks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -20, 1, 0)
mesh = SubResource("RockMesh")
surface_material_override/0 = SubResource("RockMaterial")

[node name="Rock2" type="MeshInstance3D" parent="Environment/Rocks"]
transform = Transform3D(0.866, 0, 0.5, 0, 1, 0, -0.5, 0, 0.866, 20, 1, 0)
mesh = SubResource("RockMesh")
surface_material_override/0 = SubResource("RockMaterial")

[node name="Rock3" type="MeshInstance3D" parent="Environment/Rocks"]
transform = Transform3D(0.707, 0, 0.707, 0, 1, 0, -0.707, 0, 0.707, 0, 1, -20)
mesh = SubResource("RockMesh")
surface_material_override/0 = SubResource("RockMaterial")

[node name="Rock4" type="MeshInstance3D" parent="Environment/Rocks"]
transform = Transform3D(0.866, 0, -0.5, 0, 1, 0, 0.5, 0, 0.866, 0, 1, 20)
mesh = SubResource("RockMesh")
surface_material_override/0 = SubResource("RockMaterial")

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavMesh")

[node name="Sigil" type="Node3D" parent="." groups=["sigil"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.15, 0)
script = ExtResource("4")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Sigil"]
mesh = SubResource("SigilMesh")
surface_material_override/0 = SubResource("SigilMaterial")

[node name="Props" type="Node3D" parent="."]

[node name="Crate1" parent="Props" instance=ExtResource("5")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8, 0, -8)

[node name="Crate2" parent="Props" instance=ExtResource("5")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, -8)

[node name="Crate3" parent="Props" instance=ExtResource("5")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8, 0, 8)

[node name="Crate4" parent="Props" instance=ExtResource("5")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, 8)

[node name="SpawnPoints" type="Node3D" parent="."]

[node name="PlayerSpawn1" type="Marker3D" parent="SpawnPoints" groups=["player_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 1, 4)

[node name="PlayerSpawn2" type="Marker3D" parent="SpawnPoints" groups=["player_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 1, 4)

[node name="PlayerSpawn3" type="Marker3D" parent="SpawnPoints" groups=["player_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 1, -4)

[node name="PlayerSpawn4" type="Marker3D" parent="SpawnPoints" groups=["player_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 1, -4)

[node name="ZombieSpawn1" type="Marker3D" parent="SpawnPoints" groups=["zombie_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -45, 1, -40)

[node name="ZombieSpawn2" type="Marker3D" parent="SpawnPoints" groups=["zombie_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 45, 1, -40)

[node name="ZombieSpawn3" type="Marker3D" parent="SpawnPoints" groups=["zombie_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -45, 1, 40)

[node name="ZombieSpawn4" type="Marker3D" parent="SpawnPoints" groups=["zombie_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 45, 1, 40)

[node name="ZombieSpawn5" type="Marker3D" parent="SpawnPoints" groups=["zombie_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -45)

[node name="ZombieSpawn6" type="Marker3D" parent="SpawnPoints" groups=["zombie_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 45)

[node name="ZombieSpawn7" type="Marker3D" parent="SpawnPoints" groups=["zombie_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -45, 1, 0)

[node name="ZombieSpawn8" type="Marker3D" parent="SpawnPoints" groups=["zombie_spawn"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 45, 1, 0)

[node name="Lighting" type="Node3D" parent="."]

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Lighting"]
transform = Transform3D(0.866, -0.354, 0.354, 0, 0.707, 0.707, -0.5, -0.612, 0.612, 0, 30, 0)
light_color = Color(1, 0.98, 0.9, 1)
light_energy = 1.2
shadow_enabled = true

[node name="AmbientLight" type="OmniLight3D" parent="Lighting"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 10, 0)
light_color = Color(0.8, 0.9, 1, 1)
light_energy = 0.3
omni_range = 100.0

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]

[node name="Player" parent="." instance=ExtResource("2")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 10)

[node name="UI" type="CanvasLayer" parent="."]

[node name="HUD" parent="UI" instance=ExtResource("6")]

[node name="ChatUI" parent="UI" instance=ExtResource("7")]
